/*! javascript-qrcode: Quick Response Code (QR-Code) Model 2 generator in plain javascript. 2014-03-21 07:01 */
Array.prototype.parseInt=function(a){"use strict";return a=a||10,this.map(function(b){return parseInt(b,a)})};var GeneratorPolynominal=function(){"use strict";this.log=[],this.antilog=[],this.symbol=",",this.createLogAndAntilog()};GeneratorPolynominal.prototype.constructor=GeneratorPolynominal,GeneratorPolynominal.prototype.createLogAndAntilog=function(){"use strict";for(var a=0;256>a;a+=1){for(var b=1,c=a;c>0;)b<<=1,b=b>255?285^b:b,c-=1;this.log[a]=b,this.antilog[b]=a}},GeneratorPolynominal.prototype.exp2int=function(a){"use strict";return this.log[a]},GeneratorPolynominal.prototype.int2exp=function(a){"use strict";return this.antilog[a]},GeneratorPolynominal.prototype.multiply=function(a,b){"use strict";for(var c,d,e,f,g={},h=[],i=0;i<b.length;i+=1)for(var j=0;j<a.length;j+=1){e=a[j],f=b[i];var k=e.split(this.symbol).parseInt(),l=f.split(this.symbol).parseInt();e=k[0]+l[0],f=k[1]+l[1],e%=255,f%=255,f=this.symbol+f,"undefined"==typeof g[f]&&(g[f]=[]),g[f].push(e)}for(var m in g)if(g.hasOwnProperty(m)){if(c=0,d=parseInt(m.toString().replace(/\D/,"")),e=parseInt(g[m][0]),g[m].length>1){f=parseInt(g[m][1]),e=this.exp2int(e),f=this.exp2int(f);var n=e^f;c=this.int2exp(n)}else c=e;c%=255,h.push(c+this.symbol+d)}return h},GeneratorPolynominal.prototype.polynominal=function(a){"use strict";var b=[],c=1,d=["0"+this.symbol+"1","0"+this.symbol+"0"];do{var e=["0"+this.symbol+"1",c+this.symbol+"0"];d=this.multiply(d,e),c+=1}while(a>c);for(;d.length>0;){var f=d.shift().split(this.symbol).shift();b.push(parseInt(f))}return b};var Config=function(){};Config.prototype.constructor=Config,Config.prototype.xorBits=function(a,b){"use strict";return(parseInt(a,2)^parseInt(b,2)).toString(2)},Config.prototype.getVersionInformationString=function(a){"use strict";for(var b="1111100100101",c=parseInt(a).toString(2);c.length<6;)c="0"+c;for(var d=c;d.length<18;)d+="0";for(d=d.replace(/^0+/,"");d.length>=13;){for(var e=b;e.length<d.length;)e+="0";d=this.xorBits(e,d),d=d.replace(/^0+/,"")}for(;d.length<12;)d="0"+d;return c+d},Config.prototype.getFormatString=function(a,b){"use strict";a=a||"M",b=b||0;for(var c="10100110111",d="101010000010010",e="",f="",g=this.correctionLevels[a].toString(2);g.length<2;)g="0"+g;e+=g;for(var h=parseInt(b).toString(2);h.length<3;)h="0"+h;for(e+=h,f=e;f.length<15;)f+="0";for(f=f.replace(/^0+/,"");f.length>=11;){for(var i=c;i.length<f.length;)i+="0";f=this.xorBits(i,f),f=f.replace(/^0+/,"")}for(;f.length<10;)f="0"+f;for(e+=f,e=this.xorBits(e,d);e.length<15;)e="0"+e;return e},Config.prototype.correctionLevels={L:1,M:0,Q:3,H:2},Config.prototype.remainderBits={1:0,2:7,3:7,4:7,5:7,6:7,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:3,15:3,16:3,17:3,18:3,19:3,20:3,21:4,22:4,23:4,24:4,25:4,26:4,27:4,28:3,29:3,30:3,31:3,32:3,33:3,34:3,35:0,36:0,37:0,38:0,39:0,40:0},Config.prototype.dataSizeInfo={"1-L":["19","7","1","19","(19*1) = 19"],"1-M":["16","10","1","16","(16*1) = 16"],"1-Q":["13","13","1","13","(13*1) = 13"],"1-H":["9","17","1","9","(9*1)  =  9"],"2-L":["34","10","1","34","(34*1) = 34"],"2-M":["28","16","1","28","(28*1) = 28"],"2-Q":["22","22","1","22","(22*1) = 22"],"2-H":["16","28","1","16","(16*1) = 16"],"3-L":["55","15","1","55","(55*1) = 55"],"3-M":["44","26","1","44","(44*1) = 44"],"3-Q":["34","18","2","17","(17*2) = 34"],"3-H":["26","22","2","13","(13*2) = 26"],"4-L":["80","20","1","80","(80*1) = 80"],"4-M":["64","18","2","32","(32*2) = 64"],"4-Q":["48","26","2","24","(24*2) = 48"],"4-H":["36","16","4","9","(9*4) = 36"],"5-L":["108","26","1","108","(108*1) = 108"],"5-M":["86","24","2","43","(43*2) = 86"],"5-Q":["62","18","2","15","2","16","(15*2) + (16*2) = 62"],"5-H":["46","22","2","11","2","12","(11*2) + (12*2) = 46"],"6-L":["136","18","2","68","(68*2) = 136"],"6-M":["108","16","4","27","(27*4) = 108"],"6-Q":["76","24","4","19","(19*4) = 76"],"6-H":["60","28","4","15","(15*4) = 60"]},Config.prototype.dataModeBitStrings={numeric:"0001",alphanumeric:"0010",binary:"0100",kanji:"1000"},Config.prototype.wordSizes={numeric:{"1-9":10,"10-26":12,"27-40":14},alphanumeric:{"1-9":9,"10-26":11,"27-40":13},binary:{"1-9":8,"10-26":16,"27-40":16},kanji:{"1-9":8,"10-26":10,"27-40":12}},Config.prototype.alignmentPatternLocations={1:[],2:[6,18],3:[6,22],4:[6,26],5:[6,30],6:[6,34],7:[6,22,38],8:[6,24,42],9:[6,26,46],10:[6,28,50],11:[6,30,54],12:[6,32,58],13:[6,34,62],14:[6,26,46,66],15:[6,26,48,70],16:[6,26,50,74],17:[6,30,54,78],18:[6,30,56,82],19:[6,30,58,86],20:[6,34,62,90],21:[6,28,50,72,94],22:[6,26,50,74,98],23:[6,30,54,78,102],24:[6,28,54,80,106],25:[6,32,58,84,110],26:[6,30,58,86,114],27:[6,34,62,90,118],28:[6,26,50,74,98,122],29:[6,30,54,78,102,126],30:[6,26,52,78,104,130],31:[6,30,56,82,108,134],32:[6,34,60,86,112,138],33:[6,30,58,86,114,142],34:[6,34,62,90,118,146],35:[6,30,54,78,102,126,150],36:[6,24,50,76,102,128,154],37:[6,28,54,80,106,132,158],38:[6,32,58,84,110,136,162],39:[6,26,54,82,110,138,166],40:[6,30,58,86,114,142,170]},Config.prototype.characterCapacities={1:{L:{numeric:41,alphanumeric:25,binary:17,kanji:10},M:{numeric:34,alphanumeric:20,binary:14,kanji:8},Q:{numeric:27,alphanumeric:16,binary:11,kanji:7},H:{numeric:17,alphanumeric:10,binary:7,kanji:4}},2:{L:{numeric:77,alphanumeric:47,binary:32,kanji:20},M:{numeric:63,alphanumeric:38,binary:26,kanji:16},Q:{numeric:48,alphanumeric:29,binary:20,kanji:12},H:{numeric:34,alphanumeric:20,binary:14,kanji:8}},3:{L:{numeric:127,alphanumeric:77,binary:53,kanji:32},M:{numeric:101,alphanumeric:61,binary:42,kanji:26},Q:{numeric:77,alphanumeric:47,binary:32,kanji:20},H:{numeric:58,alphanumeric:35,binary:24,kanji:15}},4:{L:{numeric:187,alphanumeric:114,binary:78,kanji:48},M:{numeric:149,alphanumeric:90,binary:62,kanji:38},Q:{numeric:111,alphanumeric:67,binary:46,kanji:28},H:{numeric:82,alphanumeric:50,binary:34,kanji:21}},5:{L:{numeric:255,alphanumeric:154,binary:106,kanji:65},M:{numeric:202,alphanumeric:122,binary:84,kanji:52},Q:{numeric:144,alphanumeric:87,binary:60,kanji:37},H:{numeric:106,alphanumeric:64,binary:44,kanji:27}},6:{L:{numeric:322,alphanumeric:195,binary:134,kanji:82},M:{numeric:255,alphanumeric:154,binary:106,kanji:65},Q:{numeric:178,alphanumeric:108,binary:74,kanji:45},H:{numeric:139,alphanumeric:84,binary:58,kanji:36}},7:{L:{numeric:370,alphanumeric:224,binary:154,kanji:95},M:{numeric:293,alphanumeric:178,binary:122,kanji:75},Q:{numeric:207,alphanumeric:125,binary:86,kanji:53},H:{numeric:154,alphanumeric:93,binary:64,kanji:39}},8:{L:{numeric:461,alphanumeric:279,binary:192,kanji:118},M:{numeric:365,alphanumeric:221,binary:152,kanji:93},Q:{numeric:259,alphanumeric:157,binary:108,kanji:66},H:{numeric:202,alphanumeric:122,binary:84,kanji:52}},9:{L:{numeric:552,alphanumeric:335,binary:230,kanji:141},M:{numeric:432,alphanumeric:262,binary:180,kanji:111},Q:{numeric:312,alphanumeric:189,binary:130,kanji:80},H:{numeric:235,alphanumeric:143,binary:98,kanji:60}},10:{L:{numeric:652,alphanumeric:395,binary:271,kanji:167},M:{numeric:513,alphanumeric:311,binary:213,kanji:131},Q:{numeric:364,alphanumeric:221,binary:151,kanji:93},H:{numeric:288,alphanumeric:174,binary:119,kanji:74}},11:{L:{numeric:772,alphanumeric:468,binary:321,kanji:198},M:{numeric:604,alphanumeric:366,binary:251,kanji:155},Q:{numeric:427,alphanumeric:259,binary:177,kanji:109},H:{numeric:331,alphanumeric:200,binary:137,kanji:85}},12:{L:{numeric:883,alphanumeric:535,binary:367,kanji:226},M:{numeric:691,alphanumeric:419,binary:287,kanji:177},Q:{numeric:489,alphanumeric:296,binary:203,kanji:125},H:{numeric:374,alphanumeric:227,binary:155,kanji:96}},13:{L:{numeric:1022,alphanumeric:619,binary:425,kanji:262},M:{numeric:796,alphanumeric:483,binary:331,kanji:204},Q:{numeric:580,alphanumeric:352,binary:241,kanji:149},H:{numeric:427,alphanumeric:259,binary:177,kanji:109}},14:{L:{numeric:1101,alphanumeric:667,binary:458,kanji:282},M:{numeric:871,alphanumeric:528,binary:362,kanji:223},Q:{numeric:621,alphanumeric:376,binary:258,kanji:159},H:{numeric:468,alphanumeric:283,binary:194,kanji:120}},15:{L:{numeric:1250,alphanumeric:758,binary:520,kanji:320},M:{numeric:991,alphanumeric:600,binary:412,kanji:254},Q:{numeric:703,alphanumeric:426,binary:292,kanji:180},H:{numeric:530,alphanumeric:321,binary:220,kanji:136}},16:{L:{numeric:1408,alphanumeric:854,binary:586,kanji:361},M:{numeric:1082,alphanumeric:656,binary:450,kanji:277},Q:{numeric:775,alphanumeric:470,binary:322,kanji:198},H:{numeric:602,alphanumeric:365,binary:250,kanji:154}},17:{L:{numeric:1548,alphanumeric:938,binary:644,kanji:397},M:{numeric:1212,alphanumeric:734,binary:504,kanji:310},Q:{numeric:876,alphanumeric:531,binary:364,kanji:224},H:{numeric:674,alphanumeric:408,binary:280,kanji:173}},18:{L:{numeric:1725,alphanumeric:1046,binary:718,kanji:442},M:{numeric:1346,alphanumeric:816,binary:560,kanji:345},Q:{numeric:948,alphanumeric:574,binary:394,kanji:243},H:{numeric:746,alphanumeric:452,binary:310,kanji:191}},19:{L:{numeric:1903,alphanumeric:1153,binary:792,kanji:488},M:{numeric:1500,alphanumeric:909,binary:624,kanji:384},Q:{numeric:1063,alphanumeric:644,binary:442,kanji:272},H:{numeric:813,alphanumeric:493,binary:338,kanji:208}},20:{L:{numeric:2061,alphanumeric:1249,binary:858,kanji:528},M:{numeric:1600,alphanumeric:970,binary:666,kanji:410},Q:{numeric:1159,alphanumeric:702,binary:482,kanji:297},H:{numeric:919,alphanumeric:557,binary:382,kanji:235}},21:{L:{numeric:2232,alphanumeric:1352,binary:929,kanji:572},M:{numeric:1708,alphanumeric:1035,binary:711,kanji:438},Q:{numeric:1224,alphanumeric:742,binary:509,kanji:314},H:{numeric:969,alphanumeric:587,binary:403,kanji:248}},22:{L:{numeric:2409,alphanumeric:1460,binary:1003,kanji:618},M:{numeric:1872,alphanumeric:1134,binary:779,kanji:480},Q:{numeric:1358,alphanumeric:823,binary:565,kanji:348},H:{numeric:1056,alphanumeric:640,binary:439,kanji:270}},23:{L:{numeric:2620,alphanumeric:1588,binary:1091,kanji:672},M:{numeric:2059,alphanumeric:1248,binary:857,kanji:528},Q:{numeric:1468,alphanumeric:890,binary:611,kanji:376},H:{numeric:1108,alphanumeric:672,binary:461,kanji:284}},24:{L:{numeric:2812,alphanumeric:1704,binary:1171,kanji:721},M:{numeric:2188,alphanumeric:1326,binary:911,kanji:561},Q:{numeric:1588,alphanumeric:963,binary:661,kanji:407},H:{numeric:1228,alphanumeric:744,binary:511,kanji:315}},25:{L:{numeric:3057,alphanumeric:1853,binary:1273,kanji:784},M:{numeric:2395,alphanumeric:1451,binary:997,kanji:614},Q:{numeric:1718,alphanumeric:1041,binary:715,kanji:440},H:{numeric:1286,alphanumeric:779,binary:535,kanji:330}},26:{L:{numeric:3283,alphanumeric:1990,binary:1367,kanji:842},M:{numeric:2544,alphanumeric:1542,binary:1059,kanji:652},Q:{numeric:1804,alphanumeric:1094,binary:751,kanji:462},H:{numeric:1425,alphanumeric:864,binary:593,kanji:365}},27:{L:{numeric:3517,alphanumeric:2132,binary:1465,kanji:902},M:{numeric:2701,alphanumeric:1637,binary:1125,kanji:692},Q:{numeric:1933,alphanumeric:1172,binary:805,kanji:496},H:{numeric:1501,alphanumeric:910,binary:625,kanji:385}},28:{L:{numeric:3669,alphanumeric:2223,binary:1528,kanji:940},M:{numeric:2857,alphanumeric:1732,binary:1190,kanji:732},Q:{numeric:2085,alphanumeric:1263,binary:868,kanji:534},H:{numeric:1581,alphanumeric:958,binary:658,kanji:405}},29:{L:{numeric:3909,alphanumeric:2369,binary:1628,kanji:1002},M:{numeric:3035,alphanumeric:1839,binary:1264,kanji:778},Q:{numeric:2181,alphanumeric:1322,binary:908,kanji:559},H:{numeric:1677,alphanumeric:1016,binary:698,kanji:430}},30:{L:{numeric:4158,alphanumeric:2520,binary:1732,kanji:1066},M:{numeric:3289,alphanumeric:1994,binary:1370,kanji:843},Q:{numeric:2358,alphanumeric:1429,binary:982,kanji:604},H:{numeric:1782,alphanumeric:1080,binary:742,kanji:457}},31:{L:{numeric:4417,alphanumeric:2677,binary:1840,kanji:1132},M:{numeric:3486,alphanumeric:2113,binary:1452,kanji:894},Q:{numeric:2473,alphanumeric:1499,binary:1030,kanji:634},H:{numeric:1897,alphanumeric:1150,binary:790,kanji:486}},32:{L:{numeric:4686,alphanumeric:2840,binary:1952,kanji:1201},M:{numeric:3693,alphanumeric:2238,binary:1538,kanji:947},Q:{numeric:2670,alphanumeric:1618,binary:1112,kanji:684},H:{numeric:2022,alphanumeric:1226,binary:842,kanji:518}},33:{L:{numeric:4965,alphanumeric:3009,binary:2068,kanji:1273},M:{numeric:3909,alphanumeric:2369,binary:1628,kanji:1002},Q:{numeric:2805,alphanumeric:1700,binary:1168,kanji:719},H:{numeric:2157,alphanumeric:1307,binary:898,kanji:553}},34:{L:{numeric:5253,alphanumeric:3183,binary:2188,kanji:1347},M:{numeric:4134,alphanumeric:2506,binary:1722,kanji:1060},Q:{numeric:2949,alphanumeric:1787,binary:1228,kanji:756},H:{numeric:2301,alphanumeric:1394,binary:958,kanji:590}},35:{L:{numeric:5529,alphanumeric:3351,binary:2303,kanji:1417},M:{numeric:4343,alphanumeric:2632,binary:1809,kanji:1113},Q:{numeric:3081,alphanumeric:1867,binary:1283,kanji:790},H:{numeric:2361,alphanumeric:1431,binary:983,kanji:605}},36:{L:{numeric:5836,alphanumeric:3537,binary:2431,kanji:1496},M:{numeric:4588,alphanumeric:2780,binary:1911,kanji:1176},Q:{numeric:3244,alphanumeric:1966,binary:1351,kanji:832},H:{numeric:2524,alphanumeric:1530,binary:1051,kanji:647}},37:{L:{numeric:6153,alphanumeric:3729,binary:2563,kanji:1577},M:{numeric:4775,alphanumeric:2894,binary:1989,kanji:1224},Q:{numeric:3417,alphanumeric:2071,binary:1423,kanji:876},H:{numeric:2625,alphanumeric:1591,binary:1093,kanji:673}},38:{L:{numeric:6479,alphanumeric:3927,binary:2699,kanji:1661},M:{numeric:5039,alphanumeric:3054,binary:2099,kanji:1292},Q:{numeric:3599,alphanumeric:2181,binary:1499,kanji:923},H:{numeric:2735,alphanumeric:1658,binary:1139,kanji:701}},39:{L:{numeric:6743,alphanumeric:4087,binary:2809,kanji:1729},M:{numeric:5313,alphanumeric:3220,binary:2213,kanji:1362},Q:{numeric:3791,alphanumeric:2298,binary:1579,kanji:972},H:{numeric:2927,alphanumeric:1774,binary:1219,kanji:750}},40:{L:{numeric:7089,alphanumeric:4296,binary:2953,kanji:1817},M:{numeric:5596,alphanumeric:3391,binary:2331,kanji:1435},Q:{numeric:3993,alphanumeric:2420,binary:1663,kanji:1024},H:{numeric:3057,alphanumeric:1852,binary:1273,kanji:784}}};var DataAnalyzer=function(a){"use strict";this.config=new Config,this.encoder=new DataEncoder,this.version=a||null,this.version=parseInt(this.version),this.version=isNaN(this.version)?null:parseInt(this.version),this.modes={numeric:function(a){return null!==a.match(/^\d+$/)},alphanumeric:function(a,b){for(var c=a.split("").sort().filter(function(a,b,c){return b===c.indexOf(a)&&a.length>0});c.length>0;)if("undefined"==typeof b.encoder.alphanumericCharsTable[c.shift()])return!1;return!0},kanji:function(){return!1}}};DataAnalyzer.prototype.constructor=DataAnalyzer,DataAnalyzer.prototype.analyze=function(a,b){"use strict";if(a=a||"QRCODE","undefined"==typeof a||0===a.trim().length)throw"No data were given.";b=b||["H","Q","M","L"];var c={data:a,capacity:0,mode:"binary",eclevel:null,version:2};for(var d in this.modes)if(this.modes.hasOwnProperty(d)){var e=this.modes[d](a,this);if(e){c.mode=d;break}}for(var f in this.config.characterCapacities)if(this.config.characterCapacities.hasOwnProperty(f)){if(null!==this.version&&parseInt(f)!==this.version)continue;for(var g=0;g<b.length;g+=1){var h=b[g],i=this.config.characterCapacities[f][h][c.mode];if(a.length<=i){c.capacity=i,c.eclevel=h,c.version=parseInt(f);break}}if(c.capacity>0)break}return c};var DataEncoder=function(){"use strict";this.config=new Config,this.ec=new ErrorCorrection};DataEncoder.prototype.constructor=DataEncoder,DataEncoder.prototype.encodeNumeric=function(a){"use strict";for(var b=10,c=a.split(""),d=null,e=[],f=0;f<c.length;f+=3){var g=c.slice(f,f+3).join("");b=3*g.length+1,d=parseInt(g);for(var h=d.toString(2);h.length<b;)h="0"+h;e.push(h)}return e},DataEncoder.prototype.encodeAlphanumeric=function(a){"use strict";for(var b=11,c=a.split(""),d=null,e=[],f=c.map(function(a){return this.alphanumericCharsTable[a]},this),g=0;g<f.length;g+=2){g+1<f.length?d=45*f[g]+f[g+1]:(d=f[g],b=Math.ceil(b/2));for(var h=d.toString(2);h.length<b;)h="0"+h;e.push(h)}return e},DataEncoder.prototype.encodeBinary=function(a){"use strict";for(var b=8,c=a.split(""),d=null,e=[],f=0;f<c.length;f+=1){var g=c[f];d=g.charCodeAt(0);for(var h=d.toString(2);h.length<b;)h="0"+h;e.push(h)}return e},DataEncoder.prototype.encode=function(a,b,c,d){"use strict";var e=[],f=[];this.mode=c,this.ecLevel=d;var g="0000",h=["11101100","00010001"],i=0,j=this.config.dataModeBitStrings[this.mode],k=this.config.wordSizes[this.mode],l=parseInt(this.config.dataSizeInfo[""+b+"-"+this.ecLevel][0]),m=(parseInt(this.config.dataSizeInfo[""+b+"-"+this.ecLevel][1]),this.config.dataSizeInfo[""+b+"-"+this.ecLevel],8*l);for(var n in k)if(k.hasOwnProperty(n)){i=k[n];var o=n.split("-").parseInt();if(o[0]<=b&&o[1]>=b)break}for(var p=a.length.toString(2);p.length<i;)p="0"+p;if(f=f.concat([j,p]),"numeric"===this.mode)f=f.concat(this.encodeNumeric(a));else if("alphanumeric"===this.mode)f=f.concat(this.encodeAlphanumeric(a));else{if("binary"!==this.mode)throw"Mode "+this.mode+" is not supported.";f=f.concat(this.encodeBinary(a))}var q=f.join(""),r=[],s=m-q.length;if(4>s){g="";for(var t=0;s>t;t+=1)g+="0"}q+=g;for(var u=0;;){var v=q.substring(u,u+8);if(""===v)break;r.push(v),u+=8}for(;r[r.length-1].length<8;)r[r.length-1]+="0";for(var w=0;r.length<l;)r.push(h[w%h.length]),w+=1;e=r.map(function(a){return parseInt(a,2)});return e},DataEncoder.prototype.alphanumericCharsTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,G:16,H:17,I:18,J:19,K:20,L:21,M:22,N:23,O:24,P:25,Q:26,R:27,S:28,T:29,U:30,V:31,W:32,X:33,Y:34,Z:35," ":36,$:37,"%":38,"*":39,"+":40,"-":41,".":42,"/":43,":":44};var ErrorCorrection=function(){"use strict";this.config=new Config,this.gen=new GeneratorPolynominal};ErrorCorrection.prototype.constructor=ErrorCorrection,ErrorCorrection.prototype.getCode=function(a,b,c){"use strict";var d=parseInt(this.config.dataSizeInfo[""+b+"-"+c][1]),e=this.gen.polynominal(d),f=[];f=f.concat(a);for(var g=0;g<a.length;g+=1){for(var h=this.gen.int2exp(f[0])%255,i=0;i<e.length;i+=1){var j=(e[i]+h)%255;j=this.gen.exp2int(j),f[i]=f[i]^j}f.shift()}return f};var Matrix=function(a,b){"use strict";if(this.config=new Config,"undefined"==typeof a||isNaN(parseInt(a)))throw"Invalid version number.";this.DATA_UNDEFINED_MODULE=7,this.DATA_LIGHT_MODULE=0,this.DATA_DARK_MODULE=1,this.MASK_UNDEFINED_MODULE=15,this.MASK_POSITION_DETECTION_PATTERN=101,this.MASK_SEPARATOR=102,this.MASK_TOP_TIMER=103,this.MASK_LEFT_TIMER=104,this.MASK_ALIGNMENT_PATTERN=105,this.MASK_FIXED_DARK_MODULE=106,this.MASK_FORMAT_INFORMATION=201,this.MASK_VERSION_INFORMATION=202,this.MASK_DATA=255,this.version=parseInt(a),this.eclevel=b,this.size=4*(this.version-1)+21,this.data=this.allocate(this.size,this.DATA_UNDEFINED_MODULE),this.mask=this.allocate(this.size,this.MASK_UNDEFINED_MODULE)};Matrix.prototype.constructor=Matrix,Matrix.prototype.setStaticAreas=function(){"use strict";this.setPositionDetectionPatterns(),this.setSeparators(),this.setTimingPatterns(),this.setFixedDarkModule(),this.setAlignmentPatterns()},Matrix.prototype.setFixedDarkModule=function(){"use strict";var a=8,b=4*this.version+9;this.setDarkModule(a,b,this.MASK_FIXED_DARK_MODULE)},Matrix.prototype.setPositionDetectionPatterns=function(){"use strict";this.setPositionDetectionPattern(0,0),this.setPositionDetectionPattern(this.getSize()-7,0),this.setPositionDetectionPattern(0,this.getSize()-7)},Matrix.prototype.setSeparators=function(){"use strict";var a=0,b=0,c=0,d=this.getSize()-7,e=0,f=7;for(a=7;a>0;)a-=1,this.setLightModule(b+f,c+e+a,this.MASK_SEPARATOR),this.setLightModule(b+e+a,c+f,this.MASK_SEPARATOR);for(e=f,f=e,this.setLightModule(b+e,c+f,this.MASK_SEPARATOR),a=7;a>0;)a-=1,e=d,f=7,this.setLightModule(b+e+a,c+f,this.MASK_SEPARATOR),e=d-1,f=0,this.setLightModule(b+e,c+f+a,this.MASK_SEPARATOR);for(e=d-1,f=7,this.setLightModule(b+e,c+f,this.MASK_SEPARATOR),a=7;a>0;)a-=1,e=7,f=d,this.setLightModule(b+e,c+f+a,this.MASK_SEPARATOR),e=0,f=d-1,this.setLightModule(b+e+a,c+f,this.MASK_SEPARATOR);e=d-1,f=7,this.setLightModule(b+f,c+e,this.MASK_SEPARATOR)},Matrix.prototype.setTimingPatterns=function(){"use strict";for(var a=this.getSize()-7,b=8;a-1>b;b+=1)b%2===0?(this.setDarkModule(b,6,this.MASK_TOP_TIMER),this.setDarkModule(6,b,this.MASK_LEFT_TIMER)):(this.setLightModule(b,6,this.MASK_TOP_TIMER),this.setLightModule(6,b,this.MASK_LEFT_TIMER))},Matrix.prototype.setAlignmentPatterns=function(){"use strict";for(var a=this.config.alignmentPatternLocations[this.version],b=0;b<a.length;b+=1)for(var c=0;c<a.length;c+=1)0===b&&0===c||0===b&&c===a.length-1||b===a.length-1&&0===c||this.setAlignmentPattern(a[b],a[c])},Matrix.prototype.setReservedAreas=function(){"use strict";this.setFormatInformationArea(),this.setVersionInformationArea()},Matrix.prototype.setFormatInformationArea=function(a,b){"use strict";a=a||"000000000000000",b=b||this.data;for(var c=a.split("").map(function(a){return parseInt(a)}),d=[[],[]],e=0,f=0,g=0;c.length>0;)e=c.shift(),d[0].push(e),d[1].push(e);for(f=8,g=0;8>g;g+=1)6!==g&&(1===d[0].pop()?this.setDarkModule(f,g,this.MASK_FORMAT_INFORMATION,b):this.setLightModule(f,g,this.MASK_FORMAT_INFORMATION,b));for(f=8,g=8;f>=0;f-=1)6!==f&&(1===d[0].pop()?this.setDarkModule(f,g,this.MASK_FORMAT_INFORMATION,b):this.setLightModule(f,g,this.MASK_FORMAT_INFORMATION,b));for(f=this.size-1,g=8;f>=this.size-8;f-=1)1===d[1].pop()?this.setDarkModule(f,g,this.MASK_FORMAT_INFORMATION,b):this.setLightModule(f,g,this.MASK_FORMAT_INFORMATION,b);for(f=8,g=4*this.version+9+1;g<this.size;g+=1)1===d[1].pop()?this.setDarkModule(f,g,this.MASK_FORMAT_INFORMATION,b):this.setLightModule(f,g,this.MASK_FORMAT_INFORMATION,b)},Matrix.prototype.setVersionInformationArea=function(a,b){"use strict";if(this.version<7)return!1;a=a||"000000000000000000",b=b||this.data;for(var c,d,e,f,g=a.split("").map(function(a){return parseInt(a)}),h=[[],[]];g.length>0;)c=g.shift(),h[0].push(c),h[1].push(c);for(e=0,d=this.size-11;6>e;e+=1)for(f=0;3>f;f+=1)1===h[0].pop()?this.setDarkModule(d+f,e,this.MASK_VERSION_INFORMATION,b):this.setLightModule(d+f,e,this.MASK_VERSION_INFORMATION,b);for(e=this.size-11,d=0;6>d;d+=1)for(f=0;3>f;f+=1)1===h[1].pop()?this.setDarkModule(d,e+f,this.MASK_VERSION_INFORMATION,b):this.setLightModule(d,e+f,this.MASK_VERSION_INFORMATION,b);return!0},Matrix.prototype.allocate=function(a,b){"use strict";var c,d,e=[];for(c=0;a>c;c+=1){var f=[];for(d=0;a>d;d+=1)f[d]=b;e.push(f)}return e},Matrix.prototype.getSize=function(){"use strict";return this.size},Matrix.prototype.getData=function(){"use strict";return this.data},Matrix.prototype.getMask=function(){"use strict";return this.mask},Matrix.prototype.setAlignmentPattern=function(a,b){"use strict";var c,d,e,f;for(this.setDarkModule(a,b,this.MASK_ALIGNMENT_PATTERN),f=1,c=a-f;a+f>=c;c+=1)d=b-f,this.setLightModule(c,d,this.MASK_ALIGNMENT_PATTERN),d=b+f,this.setLightModule(c,d,this.MASK_ALIGNMENT_PATTERN);for(e=b-f;b+f>=e;e+=1)d=e,c=a-f,this.setLightModule(c,d,this.MASK_ALIGNMENT_PATTERN),c=a+f,this.setLightModule(c,d,this.MASK_ALIGNMENT_PATTERN);for(f=2,e=a-f;a+f>=e;e+=1)c=e,d=b-f,this.setDarkModule(c,d,this.MASK_ALIGNMENT_PATTERN),d=b+f,this.setDarkModule(c,d,this.MASK_ALIGNMENT_PATTERN);for(e=b-f;b+f>=e;e+=1)d=e,c=a-f,this.setDarkModule(c,d,this.MASK_ALIGNMENT_PATTERN),c=a+f,this.setDarkModule(c,d,this.MASK_ALIGNMENT_PATTERN)},Matrix.prototype.setPositionDetectionPattern=function(a,b){"use strict";var c=0,d=0;for(c=0;7>c;c+=1)d=0,this.setDarkModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN),d=6,this.setDarkModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN);for(c=1;6>c;c+=1)d=1,this.setLightModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN),d=5,this.setLightModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN);for(d=1;6>d;d+=1)c=0,this.setDarkModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN),c=6,this.setDarkModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN);for(d=1;6>d;d+=1)c=1,this.setLightModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN),c=5,this.setLightModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN);for(c=2;5>c;c+=1)for(d=2;5>d;d+=1)this.setDarkModule(b+c,a+d,this.MASK_POSITION_DETECTION_PATTERN)},Matrix.prototype.setModule=function(a,b,c,d,e){"use strict";e=e||this.data,e[b][a]=c,this.mask[b][a]=d},Matrix.prototype.setDarkModule=function(a,b,c,d){"use strict";d=d||this.data,this.setModule(a,b,this.DATA_DARK_MODULE,c,d)},Matrix.prototype.setLightModule=function(a,b,c,d){"use strict";d=d||this.data,this.setModule(a,b,this.DATA_LIGHT_MODULE,c,d)};var Tiler=function(a){"use strict";this.matrix=a,this.datay=this.matrix.getSize()-1,this.datax=this.matrix.getSize()-1,this.mask=this.matrix.getMask(),this.data=this.matrix.getData(),this.UP=-1,this.DOWN=1,this.LEFT=-1,this.RIGHT=-1,this.datadirx=this.LEFT,this.datadiry=this.UP,this.ending=!1,this.al=!1,this.check=[]};Tiler.prototype.constructor=Tiler,Tiler.prototype.remainder=function(){"use strict";for(var a=this.matrix.config.remainderBits[this.matrix.version],b="";a>0;)b+="0",a-=1;return b},Tiler.prototype.setArea=function(a,b){"use strict";var c=0,d=[],e=a.map(function(a){for(var b=a.toString(2);b.length<8;)b="0"+b;return b}),f=b.map(function(a){for(var b=a.toString(2);b.length<8;)b="0"+b;return b});d=d.concat(e),d=d.concat(f);var g=d.join("");g+=this.remainder();for(var h=g.split("").map(function(a){return parseInt(a)});h.length>0;){var i=h.shift();if("undefined"==typeof i)break;var j=this.setModule(i,c);100===j&&(i=h.shift(),this.setModule(i,c)),c+=1}},Tiler.prototype.setModule=function(a,b){"use strict";var c=this.datax,d=this.datay;if(b>0&&this.al===!1&&(c+=b%2===0?0:this.datadirx,d+=b%2===0?this.datadiry:0),"undefined"==typeof this.mask[d])10===this.datax?(this.datadiry=this.datadiry===this.UP?this.DOWN:this.UP,this.datax-=2,this.datay-=8,c=this.datax,d=this.datay,this.ending=!0):(this.datadiry=this.datadiry===this.UP?this.DOWN:this.UP,this.datax-=2,c=this.datax,d=this.datay);else{var e=this.al===!0?this.matrix.MASK_ALIGNMENT_PATTERN:this.mask[d][c];if(e!==this.matrix.MASK_UNDEFINED_MODULE)switch(e){case this.matrix.MASK_SEPARATOR:this.datadiry=this.datadiry===this.UP?this.DOWN:this.UP,this.datax-=2,c=this.datax,d=this.datay;break;case this.matrix.MASK_FORMAT_INFORMATION:this.datadiry=this.datadiry===this.UP?this.DOWN:this.UP,this.ending===!0?(this.datay=9,this.datax-=3,c=this.datax,d=this.datay,this.ending=!1):(this.datax-=2,c=this.datax,d=this.datay);break;case this.matrix.MASK_TOP_TIMER:c=this.datax,d=this.datay+(this.datadiry===this.UP?-2:2);break;case this.matrix.MASK_ALIGNMENT_PATTERN:if(this.datadiry===this.UP&&this.data[d][c-1]===this.matrix.DATA_UNDEFINED_MODULE){this.datay-=b%2===0?1:1,this.datax-=this.al===!1&&b%2===0?1:0,this.al=!0,d=this.datay,c=this.datax;break}c=this.datax,d=this.datay+(this.datadiry===this.UP?-6:6);break;default:return 1}}return 1===a?this.matrix.setDarkModule(c,d,this.matrix.MASK_DATA):this.matrix.setLightModule(c,d,this.matrix.MASK_DATA),this.al===!0&&this.mask[d-1][c+1]===this.matrix.MASK_UNDEFINED_MODULE?(this.al=!1,this.datax+=1,100):(this.datay=d,1)};var Mask=function(a){"use strict";this.matrix=a,this.config=new Config};Mask.prototype.constructor=Mask,Mask.prototype.apply=function(a){"use strict";for(var b={evaluation:{},data:[]},c=this.patterns[a],d=0;d<this.matrix.getSize();d+=1){b.data[d]=[];for(var e=0;e<this.matrix.getSize();e+=1)if(b.data[d][e]=this.matrix.data[d][e],this.matrix.mask[d][e]===this.matrix.MASK_DATA){var f=b.data[d][e];b.data[d][e]=c(d,e)?1^f:f}}var g=this.config.getFormatString(this.matrix.eclevel,a),h=this.config.getVersionInformationString(this.matrix.version);this.matrix.setFormatInformationArea(g,b.data),this.matrix.setVersionInformationArea(h,b.data);var i=new Evaluation(this.matrix);return b.evaluation=i.evaluatePattern(b.data),b},Mask.prototype.patterns={0:function(a,b){"use strict";return(a+b)%2===0},1:function(a){"use strict";return a%2===0},2:function(a,b){"use strict";return b%3===0},3:function(a,b){"use strict";return(a+b)%3===0},4:function(a,b){"use strict";return(Math.floor(a/2)+Math.floor(b/3))%2===0},5:function(a,b){"use strict";return a*b%2+a*b%3===0},6:function(a,b){"use strict";return(a*b%2+a*b%3)%2===0},7:function(a,b){"use strict";return((a+b)%2+a*b%3)%2===0}};var Evaluation=function(a){"use strict";this.matrix=a};Evaluation.prototype.constructor=Evaluation,Evaluation.prototype.evaluatePattern=function(a){"use strict";var b={total:0,1:0,2:0,3:0,4:0};for(var c in this.rules)if(this.rules.hasOwnProperty(c)){var d=parseInt(c),e=this.rules[d](a);b[d]=e.total,b.total+=b[d]}return b},Evaluation.prototype.rules={1:function(a){"use strict";var b,c,d,e,f,g,h={horizontal:0,vertical:0,total:0};for(b=0;b<a.length;b+=1){if(f=0,g=a[b].join(""),e=g.match(/(0{5,}|1{5,})/g),null!==e)for(d=0;d<e.length;d+=1)f+=3+e[d].length-5;h.horizontal+=f}for(c=0;c<a.length;c+=1){for(f=0,g="",b=0;b<a[0].length;b+=1)g+=a[b][c];if(e=g.match(/(0{5,}|1{5,})/g),null!==e)for(d=0;d<e.length;d+=1)f+=3+e[d].length-5;h.vertical+=f}return h.total=h.horizontal+h.vertical,h},2:function(a){"use strict";var b,c,d={found:0,total:0},e=3;for(b=0;b<a.length-1;b+=1)for(c=0;c<a[0].length-1;c+=1)a[b][c]===a[b][c+1]&&a[b][c]===a[b+1][c]&&a[b][c]===a[b+1][c+1]&&(d.found+=1);return d.total=d.found*e,d},3:function(a){"use strict";var b,c,d,e={cols:0,rows:0,total:0},f=[[1,0,1,1,1,0,1,0,0,0,0],[0,0,0,0,1,0,1,1,1,0,1]],g=40,h=!0;for(b=0;b<a.length;b+=1)for(c=0;c<a[0].length-f[0].length+1;c+=1){for(h=[!0,!0],d=0;d<f[0].length;d+=1)a[b][c+d]!==f[0][d]&&(h[0]=!1),a[b][c+d]!==f[1][d]&&(h[1]=!1);h[0]===!0&&(e.rows+=1),h[1]===!0&&(e.rows+=1)}for(c=0;c<a[0].length;c+=1)for(b=0;b<a.length-f[0].length+1;b+=1){for(h=[!0,!0],d=0;d<f[0].length;d+=1)a[b+d][c]!==f[0][d]&&(h[0]=!1),a[b+d][c]!==f[1][d]&&(h[1]=!1);h[0]===!0&&(e.cols+=1),h[1]===!0&&(e.cols+=1)}return e.total=(e.rows+e.cols)*g,e},4:function(a){"use strict";var b,c,d={dark:0,all:0,total:0},e=10;for(b=0;b<a.length;b+=1)for(c=0;c<a[0].length;c+=1)d.dark+=1===a[b][c]?1:0,d.all+=1;for(var f=d.dark/d.all*100,g={upper:0,lower:0};g.upper<f;)g.upper+=5;g.lower=g.upper-5;var h=Math.abs(g.lower-50),i=Math.abs(g.upper-50);return d.total=Math.min(h,i)*e,d}};var QrCode=function(a,b,c,d){"use strict";a=a||"QRCODE",b=b||["M"],c=c||null,d=d||null,this.info={};var e=new DataAnalyzer(d);this.info=e.analyze(a,b);var f,g,h=new DataEncoder,i=new ErrorCorrection,j={},k=h.encode(this.info.data,this.info.version,this.info.mode,this.info.eclevel),l=i.getCode(k,this.info.version,this.info.eclevel);this.matrix=new Matrix(this.info.version,this.info.eclevel),this.matrix.setStaticAreas(),this.matrix.setReservedAreas(),f=new Tiler(this.matrix),f.setArea(k,l),g=new Mask(this.matrix);var m=0;if(null===c){var n=[],o={};for(m=0;8>m;m+=1)j=g.apply(m),n.push(j.evaluation.total),o[n[m]]=m;n=n.sort(),m=o[n[0]]}else m=parseInt(c),m=isNaN(m)?0:m;this.info.pattern=m,this.info.datalen=this.info.data.length,j=g.apply(m,this.matrix.data),this.matrix.data=j.data};QrCode.prototype.getInfo=function(){"use strict";return this.info},QrCode.prototype.getData=function(){"use strict";return this.matrix.getData()},QrCode.prototype.getSize=function(){"use strict";return this.matrix.getSize()};